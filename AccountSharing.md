# FT中文网新的登录与设备管理规则

## 大的原则
- 所有设备分为三种：网站（PC、Mac和手机自带浏览器）、手机App和平板App（未来可能会增加新的种类）
- 每种类型的设备，同一个时间只允许一台设备登录使用
- 每次登录新的设备，就会把其他同类设备登出（并清除密码）

## 例子：可用于最后的测试
- 一位用户有一台电脑，一台iPhone手机，一台iPad，他在三台设备上分别登入使用订阅服务
- 他新购一台华为手机，在新的手机上登入FT中文网应用，登入成功后，我们的App会提醒他原来的这台iPhone手机已经登出
- 他在iPhone手机上启动FT中文网应用，应用提醒他因为他已经在一台新的设备上登入，所以他已经登出
- 他的一位同事在办公室用他的账号登入网站，网站提醒这位同事，在另一台电脑上已经登出
- 他刷新自己电脑上的网站页面，发现自己已经登出，并且看到一个弹窗，显示自己的账号已经在另一台设备登入

## 用户体验上的要点
### 从一台设备登入，另一台设备马上登出
- 增加这个功能之后，用户每次和服务器进行交互，都需要查验身份和设备，和目前的登录成功之后，身份就保留的情况大不一样，对服务器的潜在压力大了很多
- 对于网页来说，就是每次用户获取新内容的时候，都需要进行一次查验，看这个账户是不是依然应该处于登入状态，同时更新账户下最新登录的设备信息
- 对于原生应用来说，仍然需要在用户获取和服务器交互的时候，进行查验，同时被登出的设备应该收到一条通知推送，这就意味着我们除了收集设备ID，还需要收集通知推送的Token
- 这个查验是非常频繁的，因此必须非常高效和安全，否则会拖垮服务器，也可能成为黑客攻击的弱点
- 这个查验的请求在原声应用中很可能会被抓包，因此接口要么使用国内的服务器，要么和内容域名一致

### 设备如何计数
- 对于原生应用，可以直接取Device Id，这样只要用户不删除App，Device Id始终是一致的
- 在网页版上，只能利用Cookie生成一个guid，同一设备上的不同浏览器，会被记录为不同的guid，因此，如果你在Chrome上登入，同一台电脑上的FireFox上就会登出

### 被发现共享账户用户带来的转化机会
共享账户的用户肯定对订阅服务是有需求的，但是不愿意支付比较高的费用，因此我们可以对他们采取比较大幅度折扣的差异定价，可以在iOS平台上进行尝试，如果这能带来可观的新订户，再推广到网页端。

## 灰度推出
由于这个改变太大，我建议分阶段推出。
- 首先是设备信息收集
- 之后对超过设备限额的用户显示提示
- 在确认我们前期开发的功能完善之后，可以将超过限额的用户踢出