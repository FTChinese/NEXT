<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ad</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="preconnect" href="http://dualstack.adsame-1421766300.ap-southeast-1.elb.amazonaws.com" />
<style type="text/css">
*{margin:0;padding: 0;}
html, body{background: #<%if $smarty.get.bg !=""%><%$smarty.get.bg%><%else%>F6E9D8<%/if%>;margin:0 auto;width:100%;height:100%;overflow:hidden;}
.ad{
    width:100%;
    overflow:visible;
    position: relative;
}
.ad>div {
    margin: auto !important;
    overflow:visible;
    max-width: 100% !important;
    display:block !important;
    width:100%;
}
.ad>div div {
    margin: auto !important;
    display:block !important;
}

img {
    max-width: 100% !important;
    display: block !important;
    margin: auto !important;
}
.top-left {
    float: left;
}
.top-right {
    float: right;
}
</style>

</head>
<body>

<div class="ad"><div id="n-ad-container">


<script>

function removeAd() {
    //alert ('removeAd');
    window.parent.sendEvent('Ad Impression: Error', c.substring(0,4), c.substring(4,8), {'nonInteraction':1});
}

function loaded() {
    //alert ('loaded');
    if (window.isHouseAd === true) {
        window.parent.sendEvent('Ad Impression: House Ad', c.substring(0,4), c.substring(4,8), {'nonInteraction':1});
    }
}

var k=window.location.href;
var c = k.replace(/^.*adid=([0-9A-Za-z\-]+).*$/,"$1");
var d;
if (/^[0-9]{4}0001$/.test(c)) {
    d = c.replace(/([0-9]{4})0001/g,'$10002');
} else {
    d='';
}
var slotStr = window.parent.slotStr || '';
var parentId = k.replace(/^.*pid=([0-9A-Za-z\-]+).*$/,"$1");


var adP = '';
try {
    adP = parent.adReachability();
} catch (ignore) {

}



if (1>1 && /^20550004$/.test(c)) {
    var viewable = {
      id: 'ad-ibm-200122323',
      minimum: 0.6,
      time: 1000
    };
} else if (/^20220121$/.test(c)) {// wyc test









(function() {
// MARK: - Parameters needed for each creative
var headline = '酩悦轩尼诗天猫旗舰店盛大开幕';
var lead = '酩悦轩尼诗进驻天猫，150万成交天价洋酒';
var image = 'https://creatives.ftimg.net/ads/shanghai/201707/information_flow_0728.jpg?';
var bgColor = '4';
var Click = 'https://moethennessy.m.tmall.com/';
var Imp = '';
var AdName = 'Paid Post';
var AssID = '';
//var adId = 'fullbody1';//wyc Add. In the real template,the variable is from the “ad.html”'s url:“/phone/ad.html?isad=0&amp;v=1209#adtype=banner-paid-post-home&amp;adid=fullbody1”
if (Imp !== '') {
    var gaServerTracker = new Image();
    gaServerTracker.src = 'http://www.ftchinese.com/index.php/ft/hit/' + AssID + '/2?ec=' + AdName + ' (' + AssID + ')' + '&ea=initiate&el=' + Imp + '&' + Math.random();
    if (typeof window.parent.sendImpToThirdParty === 'function') {
        window.parent.sendImpToThirdParty(Imp, AdName, AssID);
    } else {
        sendImpToThirdParty(Imp, AdName, AssID);
    }
}
// MARK: - Code that generate the paid post in a parent window
var adFrameContainerDiv = '';

if (typeof window.parentId === 'string' || window.parentId !== '') {
    adFrameContainerDiv = parent.document.getElementById(parentId);
    window.adId = parentId;
    console.log ('found it in Next project! ');
} else {
    adFrameContainerDiv = parent.document.getElementById('ad-' + adId);
}

var newItem = document.createElement("div");
var newItemId = 'paidpost-' + adId;//'paidpost-fullbody1'
var template = '<a id="paid-post-mpu-new" href="[Click]" target="_blank"><div class="oneStory" style="background:[background];margin:0;padding:0;border-bottom:1px solid #e9decf;"><div class="storyInner" style="padding:14px;"><div class="headline">[headline]</div>[image]<div class="lead" style="font-size:0.9em;">[lead]</div><div class="clearfloat"></div><div style="text-align: right;"><span style="color:#333;font-size:0.9em;background:#bdbdbd;padding:3px;">广告</span></div></div></div></a>';
var imageTemplate = '<div class="leftimage" style="width: 167px;height: 96px;"><img style="width:167px;height:96px;" src="https://www.ft.com/__origami/service/image/v2/images/raw/[image]?source=ftchinese&amp;width=334&amp;height=188"></div>';
var imageHTML = '';
var finalHTML = '';
var backgroundColorByUser = '';
if (image !== '') {
    image = encodeURIComponent(image);
    imageHTML = imageTemplate.replace('[image]', image);
}
switch (bgColor) {
case '0':
    backgroundColorByUser = 'transparent';
    break;
case '1':
    backgroundColorByUser = '#fbe9da';
    break;
case '2':
    backgroundColorByUser = '#f3dec8';
    break;
case '3':
    backgroundColorByUser = 'white';
    break;
case '4':
    backgroundColorByUser = '#f6e9d8';
    break;
default:
    backgroundColorByUser = 'transparent';
}
finalHTML = template.replace('[Click]', Click)
    .replace('[headline]', headline)
    .replace('[lead]', lead)
    .replace('[image]', imageHTML)
    .replace('[background]', backgroundColorByUser);
// MARK: Create the container of paid post if it doesn't exist
if (!parent.document.getElementById(newItemId)) {
    // console.log ('create the id');
    newItem.id = newItemId;
    adFrameContainerDiv.parentNode.insertBefore(newItem, adFrameContainerDiv);
} else {
    //console.log ('the id already exists');
    newItem = parent.document.getElementById(newItemId);
}
newItem.innerHTML = finalHTML;
// MARK: - Set the top border of the next story to 0 so that there's no double-line
adFrameContainerDiv.nextElementSibling.nextElementSibling.style.borderTopWidth = 0;
})();



















} else {
document.write ('<scr'+'ipt src="http://dualstack.adsame-1421766300.ap-southeast-1.elb.amazonaws.com/s?z=ft&c=' + c + slotStr + adP + '&_fallback=0" charset="gbk" onerror="removeAd()" onload="loaded()"></scr'+'ipt>');

}

// var forceBG = 'black';

// record the ad impression
try {
    window.parent.sendEvent('Ad Impression', c.substring(0,4), c.substring(4,8), {'nonInteraction':1});
} catch (ignore) {

}

if (/^1[347]000003$/.test(c) || /^1[347]000012$/.test(c) || c === '10000004') {
    setTimeout(function(){
        location.reload();
    }, 1000 * 60 * 5);
}

</script>


</div></div>
<div id="ad-bottom"></div>

<script type="text/javascript">
function findTop(obj) {
var curtop = 0;
if (obj.offsetParent) {
  do {
    curtop += obj.offsetTop;
  } while ((obj = obj.offsetParent));
  return curtop;
}
}

var adContainerHeight;
var parentIframe;
var adBottom = document.getElementById('ad-bottom');
var adHeight = findTop(adBottom);
var adResized = false;
var adFullWidth = false;


var w=0;

if ( window.parent.document.getElementById(parentId)) {
    parentIframe = window.parent.document.getElementById(parentId)
    adContainerHeight = parentIframe.offsetHeight || 0;



    // force the ad position to have a custom background
    if (typeof window.forceBG === 'string' && window.forceBG !== '') {
        document.body.style.backgroundColor = window.forceBG;
        if (parentIframe.parentNode.className.indexOf('banner-content')>=0) {
            parentIframe.parentNode.style.backgroundColor = window.forceBG;
        }
    }
    if (window.forceHeight && window.forceWidth) {
        adFullWidth = true;
        parentIframe.style.margin = 0;
        parentIframe.style.width = forceWidth + 'px';
        parentIframe.style.height = forceHeight + 'px';
        parentIframe.parentNode.style.height = forceHeight + 'px';
        parentIframe.parentNode.parentNode.parentNode.parentNode.className += ' standard';
    } else if (adHeight === 120 && adHeight - adContainerHeight > 20) {
        adResized = true;
        try {
            w = window.parent.innerWidth || window.parent.document.documentElement.clientWidth || window.parent.document.body.clientWidth;
            w = w - 60 - 15;
            if (w>1200) {
                w = 1200;
            } else {
                adHeight = w * 120/1200;
            }
            document.querySelector('.ad').className += ' standard';
            parentIframe.style.width = w + 'px';
            //parentIframe.parentNode.style.height = '120px';
            parentIframe.parentNode.parentNode.parentNode.parentNode.className += ' standard';
            document.querySelector('.ad img').style.width = w+'px';
            document.querySelector('.ad img').style.height = adHeight+'px';
        } catch(ignore){

        }
    } else if (adHeight > 0 &&  adHeight - adContainerHeight > 20) {
        adResized = true;
    }
    if (adResized === true) {
        parentIframe.style.height = adHeight + 'px';
        try {
            if (w<=1200) {
                if (parentId.indexOf('mpu')>=0) {
                    //alert (paretId);
                    parentIframe.parentNode.style.height = 'auto';
                } else {
                    parentIframe.parentNode.style.height = adHeight + 'px';
                }
            }
            window.parent.stickyBottomPrepare();            
        } catch (err) {
            setTimeout (function(){
                window.parent.stickyBottomPrepare(); 
            }, 3000);
        }
    } else if (adFullWidth === true) {
        try {
            window.parent.stickyBottomPrepare();
        } catch (ignore) {
            setTimeout (function(){
                window.parent.stickyBottomPrepare(); 
            }, 3000);
        }
    }

    // if there's need track viewability
    if (typeof viewable === 'object') {
        setTimeout(function() {
            if (typeof window.parent.viewablesInit === 'function') {
                viewable.top = findTop (parentIframe.parentNode);
                viewable.height = parentIframe.parentNode.offsetHeight;
                viewable.viewed = false;
                window.parent.viewables.push(viewable);
                window.parent.viewablesInit();
                window.parent.trackViewables();
                //console.log (window.parent.viewables);
            }
        }, 1000);
    }
    
}

if (window.parent && parentId !== '' && /^banner/.test(parentId) && typeof stickyHeight === 'number' && stickyHeight > 0) {
    if (typeof window.parent.stickyAds !== 'object') {
        window.parent.stickyAds = [];
    }
    window.parent.stickyAds.push({
        'BannerId': parentId,
        'stickyHeight': stickyHeight
    });
    try {
        window.parent.stickyAdsPrepare();
        window.parent.stickyBottomPrepare();
    } catch (ignore) {
        
    }
}
//in a iframe of h5 template
if (window.parent && typeof window.parent.mpuAds === 'object' && parentId !== '') {
    if (typeof parentIframe === 'object') {
        var parentContainer = parentIframe.parentNode;
        var overlayLink;
        var adUrl = '';

        if (document.querySelector('.ad a')) {
            adUrl = document.querySelector('.ad a').href || '';
        }
        
        if (adUrl !== '') {
            if (parentContainer.getElementsByTagName('a').length===0) {
                overlayLink = document.createElement("a");
                parentContainer.appendChild(overlayLink);
            } else {
                overlayLink = parentContainer.getElementsByTagName('a')[0];
            }
            parentContainer.style.position = 'relative';
            overlayLink.href = adUrl;
            overlayLink.style.position = 'absolute';
            overlayLink.style.width = '100%';
            overlayLink.style.height = '100%';
            overlayLink.style.display = 'block';
            overlayLink.style.top = 0;
            overlayLink.style.left = 0;
            overlayLink.target = '_blank';
        }
    }
}

if (document.querySelector('.ad').innerHTML.indexOf('N5840.139612.1071020274421/B20208468.203238953;dc_trk_aid=403040961') > 0) {
    parent.window.gCanReplaceInstoryWithAd = true;
    parent.window.gReplacedInstroyWithAd = false;
}

if (parentIframe && window.hideAdSign && window.hideAdSign !== '') {
    var adClassName = parentIframe.parentNode.className;
    parentIframe.parentNode.className = adClassName + ' hide-sign';
}
</script>


</body>
</html>