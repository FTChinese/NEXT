<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ad</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="preconnect" href="http://dualstack.adsame-1421766300.ap-southeast-1.elb.amazonaws.com" />
<style type="text/css">
*{margin:0;padding: 0;}
html, body{background: #F6E9D8;margin:0 auto;width:100%;height:100%;overflow:hidden;}
.ad{
    width:100%;
    overflow:visible;
    position: relative;
}
.ad>div {
    margin: auto !important;
    overflow:visible;
    max-width: 100% !important;
    display:block !important;
    width:100%;
    text-align: center;

}
.ad>div div {
    margin: auto !important;
    display:block !important;
}

img {
    max-width: 100% !important;
    display: block !important;
    margin: auto !important;
}
.top-left {
    float: left;
}
.top-right {
    float: right;
}
</style>

</head>
<body>

<div class="ad">
    <div id="n-ad-container">
        <script>
            function removeAd() {
                //alert ('removeAd');
                window.parent.sendEvent('Ad Impression: Error', adChannelId, adPositionId, {'nonInteraction':1});
            }
            function loaded() {
                //alert ('loaded');
                if (window.isHouseAd === true) {
                    window.parent.sendEvent('Ad Impression: House Ad', adChannelId, adPositionId, {'nonInteraction':1});
                }
            }
            var k=window.location.href;
            var c = k.replace(/^.*adid=([0-9A-Za-z\-]+).*$/,'$1');
            var d;
            if (/^[0-9]{4}0001$/.test(c)) {
                d = c.replace(/([0-9]{4})0001/g,'$10002');
            } else {
                d='';
            }
            var adChannelId;
            var adPositionId;


            var parentId = k.replace(/^.*pid=([0-9A-Za-z\-]+).*$/,'$1');
            if (/^[0-9]{12}$/.test(c)) {
                adChannelId = c.substring(0,8);
                adPositionId = c.substring(8,12);
                parentId = 'ad-'+parentId;
            } else {
                adChannelId = c.substring(0,4);
                adPositionId = c.substring(4,8);
            }

            var refreshParameter = '';
            if (/&refresh=1/.test(k)) {
                refreshParameter = '&_refresh=1';
            } else {
                refreshParameter = '&_refresh=0';
            }

            var slotStr = window.parent.slotStr || '';

            var adP = '';
            try {
                adP = parent.adReachability();
            } catch (ignore) {
            }

            var randNumber = parseInt(Math.random() * 10000000000, 10).toString();
            var adpatternCode = c.substr(-4,4);
            if (c === '20220101' || c === '20220102' || c === '20230101' || c === '20230102' || adpatternCode === '0301' || adpatternCode === '0351') {
                parent.window.gRand = randNumber;
            }
            var trString = '&tr=' + c + '_' + randNumber;

            if (1>1 && /^20550004$/.test(c)) {
                var viewable = {
                id: 'ad-ibm-200122323',
                minimum: 0.6,
                time: 1000
                };
            } else if (1<0 && /^300013000301$/.test(c)) {









    var ImgPortrait = 'http://creatives.ftchinese.com/ads/beijing/201804/828x1472_cn_ml.jpg';
    var ImgLandscape = 'http://creatives.ftchinese.com/ads/beijing/201804/828x1472_cn_ml.jpg';
    var Imp = 'http://bsch.serving-sys.com/serving/adServer.bs?cn=display&c=19&mc=imp&pli=24662415&PluID=0&ord=__TIME__&rtu=-1&mb=1';
    var AdName = 'Web App Full Screen AD';
    var AssID = '606513';
    if (Imp !== '') {
        var gaServerTracker = new Image();
        gaServerTracker.src = 'http://www.ftchinese.com/index.php/ft/hit/' + AssID + '/2?ec=' + AdName + ' (' + AssID + ')' + '&ea=initiate&el=' + encodeURIComponent(Imp) + '&' + Math.random();
        if (typeof window.parent.sendImpToThirdParty === 'function') {
            window.parent.sendImpToThirdParty(Imp, AdName, AssID);
        } else {
            sendImpToThirdParty(Imp, AdName, AssID);
        }
    }
    function sendImpToThirdParty(t,e,r){if("string"==typeof t){"object"!=typeof window.parent.gTrackThirdParyImpression&&(window.parent.gTrackThirdParyImpression={});var n=0,a=t,i=!1,o=function(){var t=arguments[0]||"",e=arguments[1]||"",n=arguments[2]||"",a="G"+Math.round(1e12*Math.random());try{window.parent.ga("send","event",t,e,n,{nonInteraction:1})}catch(o){var i=new Image;i.src="http://www.ftchinese.com/index.php/ft/hit/"+r+"/2?ec="+t+"&ea="+e+"&el="+encodeURIComponent(n)+"&r="+a}},c=function(){var d,s="IMG"+Math.round(1e12*Math.random()),p=(new Date).getTime(),h=t;try{d=arguments[0]||""}catch(t){d=""}h.indexOf("?")<0&&(h+="?"),h=h.replace("ord=[timestamp]","ord="+p)+"&"+s+"&ftctime="+p,n>0&&(0===a.indexOf("https")?(h=h.replace("https://ad.doubleclick.net","http://ad.doubleclick.net"),h=h.replace("https://v.admaster.com.cn","http://v.admaster.com.cn")):(h=h.replace("http://ad.doubleclick.net","https://ad.doubleclick.net"),h=h.replace("http://v.admaster.com.cn","https://v.admaster.com.cn"))),a=h,window.parent.gTrackThirdParyImpression[s]=new Image,window.parent.gTrackThirdParyImpression[s].src=h,window.parent.gTrackThirdParyImpression[s].title=e+" ("+r+")",window.parent.gTrackThirdParyImpression[s].alt=t,window.parent.gTrackThirdParyImpression[s].onload=function(){var t="";t=0===n?"Success":""!==d?"Success on Retry"+d:"Success on Retry"+n,o(this.title,t,this.alt),delete window.parent.gTrackThirdParyImpression[s],i=!0},window.parent.gTrackThirdParyImpression[s].onerror=function(){var t="";if(t=0===n?"Fail":""!==d?"Fail on Retry"+d:"Fail on Retry"+n,o(this.title,t,this.alt),o("Fail UA String",r,window.parent.adReachability()),"string"==typeof window.uaString)try{window.parent._hmt.push(["_trackEvent",this.title,"Fail",window.uaString])}catch(t){}++n<=3&&setTimeout(c,100*n*n*n)}};c(),setTimeout(function(){if(i===!1&&0===n){n=2;c(" from Pending"),o(e+" ("+r+")","Request from Pending",t)}},1e4),o(e+" ("+r+")","Request",t)}}
    // MARK: - get window width and height
    try {
        w = window.parent.innerWidth || window.parent.document.documentElement.clientWidth || window.parent.document.body.clientWidth;
        h = window.parent.innerHeight || window.parent.document.documentElement.clientHeight || window.parent.document.body.clientHeight;
    } catch (ignore) {
        w = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
        h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
    }
    if (w > h) {
        var newW = w;
        w = h;
        h = newW;
    }
    if (ImgPortrait === '') {
        ImgLandscape = 'https://www.ft.com/__origami/service/image/v2/images/raw/' + encodeURIComponent(ImgLandscape) + '?source=ftchinese&width=' + 828;
        ImgPortrait = ImgLandscape;
    } else if (ImgLandscape === '') {
        ImgPortrait = 'https://www.ft.com/__origami/service/image/v2/images/raw/' + encodeURIComponent(ImgPortrait) + '?source=ftchinese&width=' + 828;
        ImgLandscape = ImgPortrait;
    } else {
        ImgPortrait = 'https://www.ft.com/__origami/service/image/v2/images/raw/' + encodeURIComponent(ImgPortrait) + '?source=ftchinese&width=' + 828;
        ImgLandscape = 'https://www.ft.com/__origami/service/image/v2/images/raw/' + encodeURIComponent(ImgLandscape) + '?source=ftchinese&width=' + 828;
    }
    var url = parent.window.location.href;
    if (typeof(url) != 'undefined') {
        (function() {
            var adOpacity = '1';
            var adImage = ImgLandscape;
            var adImage2 = ImgPortrait;
            var adImp = Imp;
            // MARK: Landscape
            var adWidth = h;
            var adHeight = w;
            // MARK: Portrait
            var adWidth2 = w;
            var adHeight2 = h;
            var closeButtonPosition = '';
            var adClass1 = (adWidth < 820) ? 'mobile-landscape' : 'wide-screen';
            var adClass2 = (adWidth < 820) ? 'mobile-portrait' : 'narrow-screen';
            var adCode = '';
            adLink = 'http://dualstack.adsame-1421766300.ap-southeast-1.elb.amazonaws.com/c?z=ft&la=0&si=600&cg=1300&c=300013000101&ci=710&or=4040&l=606513&bg=10167&b=31995&u=http://bsch.serving-sys.com/serving/adServer.bs?cn=trd&mc=click&pli=24662415&PluID=0&ord=__TIME__&mb=1';
            if (adLink.indexOf('?') > 0 && !adLink.indexOf('?http')) {
                adLink += '&isad=1';
            } else {
                adLink += '?isad=1';
            }
            adCode = '<div class=overlayBG style="opacity:' + adOpacity + '"></div><div class=inner><div class=cell><div class="' + adClass1 + '" style="width:' + adWidth + 'px;height:' + adHeight + 'px;margin:auto;position:relative;"><div class="o-overlay__close" style="top:0;right:0;"><div class="o-overlay__close-icon" onclick="closeOverlay()"></div></div><a href="' + adLink + '" target=_blank><div style="width:' + adWidth + 'px;height:' + adHeight + 'px;background-image: url(' + adImage + ');background-repeat: no-repeat;background-size:cover;"></div></a></div><div class="' + adClass2 + '" style="width:' + adWidth2 + 'px;height:' + adHeight2 + 'px;margin:auto;position:relative;"><div class="o-overlay__close" style="top:0;right:0;"><div class="o-overlay__close-icon" onclick="closeOverlay()"></div></div><a href="' + adLink + '" target=_blank><div style="width:' + adWidth2 + 'px;height:' + adHeight2 + 'px;background-image: url(' + adImage2 + ');background-repeat: no-repeat;background-size:cover;"></div></a></div></div>';
            var popAd = parent.parent.document.getElementById("pop-ad");
            var popAdClass = popAd.className;
            var img = new Image();
            img.src = adImage;
            console.log ('yes! yes! ');
            if (popAdClass.indexOf('done') < 0) {
                img.onload = function() {
                    var img2 = new Image();
                    img2.src = adImage2;
                    img2.onload = function() {
                        popAd.innerHTML = adCode;
                        if (popAdClass.indexOf('in-page') < 0) {
                            popAd.className = 'overlay on done';
                            setTimeout(function() {
                                    popAd.className = 'overlay done';
                                    popAd.innerHTML = '';
                                },
                                5000);
                        } else {
                            popAd.className += ' on';
                        }
                    };
                };
            }
        }());
    }






















            } else {
                console.log ('print url: c is now ' + c);
                document.write ('<scr'+'ipt src="http://dualstack.adsame-1421766300.ap-southeast-1.elb.amazonaws.com/s?z=ft&c=' + c + slotStr + trString + adP + '&_fallback=0' + refreshParameter + '" charset="gbk" onerror="removeAd()" onload="loaded()"></scr'+'ipt>');
            }

            // record the ad impression
            try {
                window.parent.sendEvent('Ad Impression', adChannelId, adPositionId, {'nonInteraction':1});
            } catch (ignore) {

            }

            try {
                window.parent.document.querySelector('.banner-content').style.backgroundColor = 'transparent';
            } catch (ignore) {

            }



            // if (c === '100088880301') {
            //     var parentFrame = window.parent.document.getElementById(window.parentId);
            //     if (typeof parentFrame === 'object') {
            //         parentFrame.style.width = '970px';
            //     }
            // }


        </script>
    </div>
</div>

<div id="ad-bottom"></div>


<script>
try {
    var stateObj = {foo: 'bar'};
    var newUrl = window.location.href + '&refresh=1';
    history.pushState(stateObj, '', newUrl);
} catch (ignore) {

}

//window.refreshTime = 10;
// if (/1000[0-9]{4}0201|1000[0-9]{4}0411|1000[0-9]{4}0412|1000[0-9]{4}0421|1000[0-9]{4}0301/.test(c)) {
//     setTimeout(function(){
//         if ( window.parent.document.getElementById(parentId)) {
//             parentIframe = window.parent.document.getElementById(parentId);
//             var divAddedByClient = parentIframe.parentNode.querySelectorAll('div')[0];
//             if (divAddedByClient !== undefined) {
//                 divAddedByClient.outerHTML = '';
//                 delete divAddedByClient;
//             }
//             parentIframe.style = '';
//             parentIframe.setAttribute('width', '100%');
//         }
//         location.reload(false);
//     }, 1000 * 60 * window.refreshTime);
// }


window.refreshTime = 10;
window.recoverOriginalUrlTime = 0.1;

if (/1000[0-9]{4}0201|1000[0-9]{4}0411/.test(c)) {

    var parentPathName = '/';

    try {
        parentPathName = parent.window.location.pathname;
        if (parent && typeof parent.window.OriginalUrlString === 'string') {
            parentPathName = parent.window.OriginalUrlString; 
        } else {
            parent.window.OriginalUrlString = parentPathName;
        }
    } catch (ignore) {

    }


    setTimeout(function(){
        var adPosition;
        if (/1000[0-9]{4}0201/.test(c)) {
            adPosition = '0201';
        } else {
            adPosition = '0411';
        }
        if ( window.parent.document.getElementById(parentId)) {
            //console.log('found: ' +parentId);
            parentIframe = window.parent.document.getElementById(parentId);
            var divAddedByClient = parentIframe.parentNode.querySelectorAll('div')[0];
            if (divAddedByClient !== undefined) {
                divAddedByClient.outerHTML = '';
                delete divAddedByClient;
            }
            parentIframe.style = '';
            parentIframe.setAttribute('width', '100%');
            parentIframe.setAttribute('id', 'ad-10001902'+adPosition);
            try {
                var parentBannerContentDom = parentIframe.parentNode;
                var allEyeDivs = parentBannerContentDom.querySelectorAll('div');
                //console.log (allEyeDivs);
                for (var eyeDivIndex = 0; eyeDivIndex<allEyeDivs.length; eyeDivIndex++) {
                    parentBannerContentDom.removeChild(allEyeDivs[eyeDivIndex]);
                }
            } catch (ignore) {

            }
            try {
                var eyeDivContainer = window.parent.document.getElementById('eyeDiv');
                if (eyeDivContainer) {
                    window.parent.document.body.removeChild(eyeDivContainer);
                }
            } catch (ignore) {

            }
        }

        parent.window.history.replaceState({
            foo: 'bar'
        }, '', '/channel/viewtop.html');

        var newHref = '/a.html?v=20171214112400#adid=10001902'+adPosition+'&pid=10001902'+adPosition;
        window.location.href = newHref;
        //console.log ('url print: change to: ' + newHref);
        location.reload(false);
    }, 1000 * 60 * window.refreshTime);

    setTimeout(function() {
        parent.window.history.replaceState({
            foo: 'bar'
        }, '', parentPathName);
    }, 1000 * 60 * window.recoverOriginalUrlTime);
}

</script>

<!-- build:js scripts/a-domore.js -->
<script src="scripts/a-domore.js"></script>
<!-- endbuild -->
</body>
</html>