<!-- Prepare for device and channel-->
<script>
var deviceType = getDeviceTpye();
var deviceId = adDevices[deviceType].id;
var adChannelId = getAdChannelId();

function getDeviceTpye() {
  /**
   * @dependGlob uaString
   * @dependGlob searchVars
   * @dest: determin device type
   */
  var deviceType = 'PC';

  if (/iPad/i.test(uaString)) {
    deviceType = 'PadWeb';
    if(searchVars.webview && searchVars.webview === 'ftcapp') {
      deviceType = 'PadApp';
    }
  } else if (/OS [0-9]+\_/i.test(uaString) && (/iPhone/i.test(uaString) || /iPod/i.test(uaString))) {
    deviceType = 'iPhoneWeb';
    if(searchVars.webview && searchVars.webview === 'ftcapp') {
      deviceType = 'iPhoneApp';
    }
  } else if (/Android|micromessenger/i.test(uaString) || w1 <= 490) {
    deviceType = 'AndroidWeb';
  }
  return deviceType;
}

function getAdChannelId() {
  /**
   * @dependGlob adchID
   * @dependGlob FTadchannelID
   * @dependGlob deviceType
   */
  var adch = adchID; //TODO:集中channel号码的获取方式，不要head.html等等都有
  var adchURL = window.location.href.replace(/^.*adchannelID=([0-9]{4}).*$/g,'$1');
  if (/^[0-9]{4}$/.test(adchURL)) { //MARK:如果是从url可以得到4位频道号
    adch = adchURL;
  } else if (typeof(window.FTadchannelID)!=='undefined' && window.FTadchannelID ) { //MARK:否则看一下全局变量FTadchannelID是否存在
    console.log(window.FTadchannelID);
    adch = window.FTadchannelID;
  } 
  //MARK:Mobile情况下的频道要抹去二级频道（一级频道为50的除外）
  //MARK：1902的移动端卖了广告，所以1902也要除去————移动端子频道分开卖广告是趋势
  var mobileDeviceTypeArr = ['iPhoneApp','iPhoneWeb','AndroidApp','AndroidWeb','PadApp','PadWeb'];
  if (adch && mobileDeviceTypeArr.indexOf(deviceType) >= 0 && adch.substring(0,2)!== '50' && adch.substring(2,4)!=='00' && adch !== '1902') {
    adch = adch.substring(0,2) + '00';
  }
  var adChannelId = adch||'1000';
  return adChannelId;
}
</script>

<!-- DB Ad -->
<script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>

<script>
    googletag.cmd.push(function() {
      var gptadslots = [];
      gptadslots[0] = googletag.defineSlot('/80682004/PC-1000/100010000201', [[969, 90], [1200, 120], [1200, 500], 'fluid', [969, 250], [1200, 400], [969, 400]], 'Leaderboard-Num1').addService(googletag.pubads());

      gptadslots[1] = googletag.defineSlot('/80682004/PC-1000/100010000301', [[969, 90], [1200, 120]], 'Banner-Num1').addService(googletag.pubads());

      gptadslots[2] = googletag.defineSlot('/80682004/PC-1000/100010000302', [[969, 90], [1200, 120]], 'Banner-Num2').addService(googletag.pubads());
      
      gptadslots[3] = googletag.defineSlot('/80682004/PC-1000/100010000303', [[969, 90], [1200, 120]], 'Banner-Num3').addService(googletag.pubads());


      gptadslots[4] = googletag.defineSlot('/80682004/PC-1000/100010000411', [[300, 250], [300, 1050], [300, 600], 'fluid', [810, 600]], 'MPU-Right1').addService(googletag.pubads());
    
      gptadslots[5] = googletag.defineSlot('/80682004/PC-1000/100010000412', [[300, 250], [300, 1050], [300, 600], 'fluid', [810, 600]], 'MPU-Right2').addService(googletag.pubads());

      googletag.pubads().enableSingleRequest();
      googletag.pubads().disableInitialLoad();
      googletag.enableServices();
      googletag.pubads().refresh(gptadslots);
    });

</script>

<!-- End Doubleclick Head -->